<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Vibe Coding Safe Review</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    textarea { width: 100%; height: 220px; }
    pre { background: #f6f6f6; padding: 12px; }
    .risk { color: red; font-weight: bold; }
    button { padding: 10px 16px; margin-top: 10px; }
  </style>
</head>
<body>

<h2>ğŸ§  ë°”ì´ë¸Œì½”ë”© ì•ˆì „ ë¦¬ë·°</h2>

<textarea id="code" placeholder="GAS / JS ì½”ë“œë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”"></textarea>
<br />
<button onclick="analyze()">ë¶„ì„</button>

<h3>ğŸ“˜ ë¼ì¸ë³„ ìì—°ì–´ ì„¤ëª…</h3>
<pre id="explain"></pre>

<h3>âš ï¸ ìœ„í—˜ ë¼ì¸</h3>
<div id="risks"></div>

<script>
  const GAS_API_URL = "https://script.google.com/macros/s/AKfycbz911fVLd7J3NskdxrEwlilLJm5lxeX8Zlmafbwf1tYG9iegumwksclzZRz8NHHV11Mww/exec";

  async function analyze() {
    const code = document.getElementById("code").value;

    const res = await fetch(GAS_API_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ code })
    });

    const data = await res.json();

    document.getElementById("explain").textContent =
      data.explanations || "ì„¤ëª… ì—†ìŒ";

    document.getElementById("risks").innerHTML =
      data.risks && data.risks.length
        ? data.risks.map(r =>
            `<div class="risk">[${r.line}ì¤„] ${r.text} â†’ ${r.reason}</div>`
          ).join("")
        : "ìœ„í—˜ ë¼ì¸ ì—†ìŒ";
  }
</script>

</body>
</html>
